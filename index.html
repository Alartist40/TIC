<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tokyo International Seventh-day Adventist Church</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- CSV Parser -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body>
    <!-- 7-Column Grid Container -->
    <div class="grid-container">
        <!-- Main Content (6/7) -->
        <main class="content-sixth">
            <!-- Enhanced Navigation -->
            <nav class="main-nav" id="main-nav">
                <div class="titles">
                    <h1>Tokyo International</h1>
                    <h1>Seventh-day Adventist Church</h1>
                </div>
                <button class="nav-toggle" aria-label="Open navigation" aria-expanded="false">
                    <span class="hamburger"></span>
                </button>
                <ul class="nav-links">
                    <li><a href="#hero">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#ministries">Ministries</a></li>
                    <li><a href="#sermons">Sermons</a></li>
                    <li><a href="#events">Events</a></li>
                    <li><a href="#visit">Visit Us</a></li>
                </ul>
            </nav>

            <!-- Enhanced Hero Section -->
            <section id="hero" class="hero">
                <h2 class="welcome" id="welcome-text">WELCOME</h2>
                <!-- Subtitle removed as per user preference in Church Website version -->
            </section>

            <!-- About Section -->
            <section id="about" class="about">
                <h2>About TIC</h2>
                
                <!-- Mission/Vision/Values Card (Dynamic) -->
                <div class="card">
                    <h3>Our Mission and Vision</h3>
                    <h4>Our Mission</h4>
                    <p>To create a vibrant, multicultural community of believers who worship God in spirit and truth, grow together in faith, and share the gospel message with the international community in Tokyo.</p>
                    <button class="more-btn" data-modal="mission">Read More</button>
                </div>
            </section>

            <!-- Pastor Section -->
            <section id="pastor">
                <h2>Our Church Pastor</h2>
                <div id="pastor-container">
                    <!-- Static Fallback (Will be replaced if Sheet has data) -->
                    <div class="card about-card">
                        <div class="pastor-verse-row">
                            <div class="pastor-square">
                                <img src="images/pastor_profile_pic.webp" alt="Pastor Guenji Imayuki">
                            </div>
                            
                            <div class="verse-box">
                                <p class="verse">
                                    "For as the rain comes down, and the snow from heaven... So shall My word be..."
                                </p>
                                <span class="ref">— Isaiah 55:10-11</span>
                            </div>
                        </div>
                        
                        <div class="pastor-info">
                            <h4>Pastor Guenji Imayuki</h4>
                            <p>Pastor Guenji Imayuki is a second-generation Japanese born in Brazil...</p>
                            <button class="more-btn" data-modal="pastor">Read Full Bio</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Ministries Section -->
            <section id="ministries" class="ministries">
                <h2>Ministries</h2>
                <div id="ministries-grid" class="card-grid">
                    <div class="card">
                        <p>Loading ministries from Google Sheet...</p>
                    </div>
                </div>
            </section>

            <!-- Sermons Section -->
            <section id="sermons" class="sermons">
                <h2>Sermons</h2>
                <!-- YouTube link will be injected here by JS -->

                <div class="card">
                    <h3>Join Us for Worship</h3>
                    <p>You can join our services both in person and online. We stream every Sabbath morning and you're always welcome to worship with our multicultural community.</p>
                    <!-- Bulletin button logic handles via JS/modal now -->
                </div>
            </section>

            <!-- Events Section -->
            <section id="events" class="events">
                <h2>Upcoming Events</h2>

                <!-- Google Calendar Integration -->
                <div class="card">
                    <h3>Church Calendar</h3>
                    <p>Stay updated with all our church activities and events through our Google Calendar.</p>
                    <div class="calendar-container">
                        <iframe src="https://calendar.google.com/calendar/embed?src=en.japanese%23holiday%40group.v.calendar.google.com&ctz=Asia%2FTokyo"
                            style="border:0" width="100%" height="400" frameborder="0" scrolling="no">
                        </iframe>
                    </div>
                </div>
            </section>

            <!-- Visit Us Section -->
            <section id="visit" class="visit">
                <h2>Visit Us</h2>

                <div class="card">
                    <h3>Thank You for Wanting to Visit Us!</h3>
                    <p>We are located on the ground floor of Tokyo Central Seventh-day Adventist Church in Harajuku, behind the Laforet shopping mall.</p>
                </div>

                <!-- Schedule container (Dynamic from Sheets) -->
                <div id="schedule-container">
                    <!-- Fallback static schedule removed, will be loaded by renderSchedule.js -->
                     <div class="card">
                        <p>Loading schedule...</p>
                     </div>
                </div>

                <div class="card">
                    <h3>How to Find Us</h3>
                    <h4>Train Travel</h4>
                    <p>Train travel is convenient and you can go anywhere but for first-time visitors it can be overwhelming. Please take the time to study the route between your accommodation and Harajuku to not be late and miss the service.</p>
                    
                    <h4>From Harajuku JR Train Station</h4>
                    <ol>
                        <li>Take the Omotesando exit (stairs going up) to leave the station.</li>
                        <li>Cross the road in front of the cosmetics store and turn right.</li>
                        <li>Follow the footpath to the left.</li>
                        <li>Walk down the footpath for about 50 meters. You will pass Nike on the left.</li>
                        <li>Take the small street (Church Avenue) to the left immediately after Softbank.</li>
                        <li>Over the rise you will see the church building on the right. The first entrance is the Japanese-language worship.</li>
                        <li>Continue around the bend to the side entrance. The entrance has a coloured stained-glass window.</li>
                        <li>The Tokyo International Seventh-day Adventist Church (TIC) is on the 1st floor.</li>
                    </ol>
                </div>

                <div class="card">
                    <h3>Address & Contact</h3>
                    <p>
                        1-11-1 Jingumae, Shibuya, Tokyo, Japan 150-0001<br>
                        Tel: +81 3-3402-1517<br>
                        Fax: +81 3-3404-2461<br>
                        Email: <a href="mailto:info@tokyoadventist.org">info@tokyoadventist.org</a>
                    </p>
                </div>

                <div class="card">
                    <h3>Connect With Us</h3>
                    <p>
                        YouTube: <a href="https://www.youtube.com/@liftupyourvoicemediaminist7959/streams" target="_blank" rel="noopener">Tokyo Adventist Church</a><br>
                        Instagram: <a href="https://instagram.com/tokyosdac" target="_blank" rel="noopener">@tokyosdac</a>
                    </p>
                </div>

                <div class="card">
                    <h3>Location Map</h3>
                    <p><a href="https://maps.app.goo.gl/j6Au8jCJPws2x1HD9" target="_blank" rel="noopener" class="gold-btn" style="display: inline-block; margin-bottom: 1rem;">Open in Google Maps App</a></p>
                    <div class="map-container">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3241.689460241809!2d139.70263531525887!3d35.66947618019585!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188cb9f8a3c3b5%3A0x4a5e78be6c4e3d3d!2s1%20Chome-11-1%20Jingumae%2C%20Shibuya%20City%2C%20Tokyo%20150-0001!5e0!3m2!1sen!2sjp!4v1700000000000!5m2!1sen!2sjp" 
                            width="100%" height="300" style="border:0;" allowfullscreen loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <footer>
                <p>&copy; <span id="year"></span> Tokyo International Seventh-day Adventist Church.</p>
                <p>Designed with the Creation Grid. Adventist symbol &copy; General Conference of Seventh-day Adventists.</p>
            </footer>
        </main>
        
        <!-- Sabbath Column (1/7) -->
        <aside class="sabbath-column" aria-hidden="true">
            <img src="images/logo/adventist-symbol--white.svg" alt="Seventh-day Adventist Symbol" class="sabbath-logo">
        </aside>
    </div>

    <!-- Modal System for Google Sheets Content -->
    <div id="modal-overlay" class="modal-overlay" style="display: none;">
        <div class="modal-container">
            <button class="modal-close" aria-label="Close modal">&times;</button>
            <div class="modal-content" id="modal-content">
                <!-- Dynamic content will be loaded here from Google Sheets -->
                <div class="modal-loading">
                    <p>Loading content from Google Sheets...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button id="back-to-top" class="back-to-top" aria-label="Back to top" style="display: none;">
        ↑
    </button>

    <!-- JS Logic -->
    <script type="module" src="js/app.js"></script>
</body>
</html>